---
title: "Report"
execute: 
  echo: true      # change to true to show the code
code-fold: false  # change to true to fold the code chunks
---

```{r}
library(tidyverse) 

covid <- read_csv("data/clean_covid_formatted.csv")
```


Your report will go here.

##Viz 1: Scores before Covid by Income Level


```{r}
covid |>
  select(subject, grade,`income_medium`, `income_high`, `income_missing`) |>
  pivot_longer(cols = c(-subject, -grade),
               names_to = "income_level",
               values_to = "scores_diff") |>
  mutate(income_level = as.factor(str_to_sentence(str_extract(income_level, "medium|high|missing")))) |>
  mutate(income_level = fct_relevel(income_level, c("medium", "high", "missing")),
         subject = as.factor(subject)) |>
  group_by(income_level, subject) |>
  summarize(mean_scores_diff = mean(scores_diff)) |>
  ggplot(aes(y = mean_scores_diff, x = income_level)) +
  geom_col() +
  facet_wrap(~subject) +
  labs(x = "Income Level",
       y = "Average Change in Scores from Midterms to Finals",
       title = "Comparing the Change in Exam Scores before Covid-19 between Income Levels")
```

## Viz 2: Scores during Covid by Income Level

```{r}
covid |>
  select(subject, grade,`COVID-19 year * Medium income household`, `COVID-19 year * High income household`) |>
  pivot_longer(cols = c(-subject, -grade),
               names_to = "income_level",
               values_to = "scores_diff") |>
  mutate(income_level = as.factor(str_to_sentence(str_extract(income_level, "Medium|High")))) |>
  mutate(income_level = fct_relevel(income_level, c("Medium", "High")),
         subject = as.factor(subject)) |>
  group_by(income_level, subject) |>
  summarize(mean_scores_diff = mean(scores_diff)) |>
  ggplot(aes(y = mean_scores_diff, x = income_level)) +
  geom_col() +
  facet_wrap(~subject) +
  labs(x = "Income Level",
       y = "Average Change in Scores from Midterms to Finals",
       title = "Comparing the Change in Exam Scores during Covid-19 between Income Levels")
```

## Viz 4: Scores During Covid By Parent Education Level

```{r}
# Viz 4: Scores During Covid By Parent Education Level
# Viz 4
covid |>
  select(subject, grade,`COVID-19 year * Parental education high`, `COVID-19 year * Parental education medium`) |>
  pivot_longer(cols = c(-subject, -grade),
               names_to = "education_level",
               values_to = "scores_diff") |>
  group_by(education_level, subject) |>
  mutate(education_level = str_sub(education_level, 35, 41)) |>
  summarize(mean_scores_diff = mean(scores_diff)) |>
  ggplot(aes(y = mean_scores_diff, x = education_level)) +
  geom_col() +
  facet_wrap(~subject) +
  labs(x = "Parental Education Level",
       y = "Average Change in Scores During Covid",
       title = "Comparing the Change in Exam Scores during Covid by Parental Education Level")
```
