---
title: "Report"
execute: 
  echo: true      # change to true to show the code
code-fold: false  # change to true to fold the code chunks
---

```{r}
library(tidyverse) 

covid <- read_csv("data/factored_covid.csv")
```


Your report will go here.

## Viz 2: Scores during Covid by Income Level

```{r}
covid |>
  filter(str_detect(VARIABLES, "income")) |>
  mutate(income_level = as.factor(str_to_sentence(str_extract(VARIABLES, "Medium|High|missing")))) |>
  mutate(income_level = fct_relevel(income_level, c("Medium", "High", "Missing"))) |>
  select(-VARIABLES, -...1, -...2) |>
  group_by(income_level, subject) |>
  summarize(mean_scores_diff = mean(scores_diff)) |>
  ggplot(aes(y = mean_scores_diff, x = income_level)) +
  geom_col() +
  facet_wrap(~subject) +
  labs(x = "Income Level", 
       y = "Average Change in Scores from Midterms to Finals", 
       title = "Comparing the Change in Exam Scores during Covid between Income Levels")
```

## Viz 4: Scores Durring Covid By Parent Education Level

```{r}
# Viz 4: Scores Durring Covid By Parent Education Level
covid |>
  filter(VARIABLES %in% c("COVID-19 year * Parental education high", "COVID-19 year * Parental education medium")) |>
  group_by(VARIABLES,subject) |>
  mutate(VARIABLES = str_sub(VARIABLES, 35, 41)) |>
  summarize(mean_scores_diff = mean(scores_diff)) |>
  ggplot(aes(y = mean_scores_diff, x = VARIABLES)) +
  geom_col() +
  facet_wrap(~subject) +
  labs(x = "Parental Education Levle", 
       y = "Average Change in Scores from Midterms to Finals", 
       title = "Comparison of the Change in Exam Scores during Covid by Parental Education Level")
```
